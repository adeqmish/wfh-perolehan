<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Log Masuk ‚Äì WFH UNISEL</title>
  <style>
    :root{--bg:#0b1020;--card:#121a33;--muted:#9fb0ff;--accent:#4da3ff;--ok:#34d399;--err:#ef4444}
    *{box-sizing:border-box} /* penting: elak input overflow */
    body{
      margin:0;min-height:100vh;
      font-family:Inter,system-ui,Segoe UI,Arial;
      color:#e9eeff;background:linear-gradient(180deg,#0b1020,#0e1429 40%,#0b1020);
      display:grid;place-items:center;padding:20px
    }
    .card{
      width:min(92%,520px);background:var(--card);
      border:1px solid rgba(255,255,255,.08);border-radius:20px;
      box-shadow:0 30px 120px rgba(0,0,0,.5);padding:22px 20px;overflow:hidden;
    }
    h1{margin:.2rem 0 1rem;font-size:26px}
    label{display:block;margin:.6rem 0 .35rem;font-weight:600}
    .input-wrap{position:relative}
    input{
      width:100%;padding:12px 14px;border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:#0c132a;color:#e9eeff;outline:none;
      transition:border-color .15s, box-shadow .15s;display:block;
    }
    input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(77,163,255,.22)}
    /* ruang untuk butang toggle di sebelah kanan */
    .input-wrap input[type="password"],
    .input-wrap input[type="text"]{padding-right:44px}

    .toggle{
      position:absolute;right:8px;top:50%;transform:translateY(-50%);
      border:0;background:transparent;color:#cfe1ff;cursor:pointer;
      padding:6px 8px;border-radius:10px;line-height:1;font-size:18px;
    }
    .toggle:hover{background:#1a254a}

    #loginBtn{
      width:100%;margin-top:14px;padding:12px 16px;border-radius:12px;border:0;
      background:var(--accent);color:#001333;font-weight:700;cursor:pointer
    }
    #loginBtn:disabled{opacity:.7;cursor:wait}
    .row-end{text-align:center;margin-top:10px}
    .row-end a{color:#b8c7ff;text-decoration:none}
    .row-end a:hover{color:#d6e1ff;text-decoration:underline}
    .status{margin-top:10px;font-size:14px}
    .status.ok{color:var(--ok)} .status.err{color:var(--err)}

    /* brand kecil atas form (optional) */
    .brand{display:flex;align-items:center;gap:10px;margin-bottom:6px}
    .brand img{height:32px;width:auto;max-width:160px;display:block} /* elak stretch */
    .brand small{color:var(--muted)}

    /* Loading overlay */
    .loading{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.72);backdrop-filter:blur(4px);z-index:70}
    .loading.show{display:flex}
    .loading-box{width:min(92%,420px);text-align:center;background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:26px 22px;box-shadow:0 30px 120px rgba(0,0,0,.6)}
    .spinner{width:54px;height:54px;border-radius:50%;margin:0 auto 12px;border:6px solid rgba(255,255,255,.12);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <main class="card">
    <div class="brand">
      <img src="https://bursary.unisel.edu.my/wp-content/uploads/sites/15/2024/05/cropped-unisel-2.png" alt="UNISEL"/>
      <small>Selamat datang</small>
    </div>
    <h1>Log Masuk</h1>

    <form id="loginForm" autocomplete="on">
      <label for="email">Emel</label>
      <div class="input-wrap">
        <input id="email" name="email" type="email" autocomplete="username" placeholder="nama@unisel.edu.my" required>
      </div>

      <label for="password">Kata Laluan</label>
      <div class="input-wrap">
        <input id="password" name="password" type="password" autocomplete="current-password" required>
        <button type="button" class="toggle" id="togglePwd" aria-label="Tunjuk kata laluan" title="Tunjuk/Sembunyi">üëÅ</button>
      </div>

      <button id="loginBtn" type="submit">Masuk</button>
      <div id="loginStatus" class="status"></div>
      <div class="row-end"><a href="forgot.html">Lupa kata laluan?</a></div>
    </form>
  </main>

  <!-- Loading overlay untuk proses login -->
  <div id="loginLoading" class="loading" aria-live="polite" aria-busy="true">
    <div class="loading-box">
      <div class="spinner" aria-hidden="true"></div>
      <h4 style="margin:.2rem 0 0">Sedang proses‚Ä¶</h4>
      <p id="loginLoadingMsg" style="color:#b8c7ff;margin:.3rem 0 0">Mengesahkan akaun</p>
    </div>
  </div>

  <script src="auth.js"></script>
  <script>
    // Toggle show/hide password
    (function(){
      const pwd = document.getElementById('password');
      const btn = document.getElementById('togglePwd');
      let shown = false;
      function update(){
        pwd.type = shown ? 'text' : 'password';
        btn.textContent = shown ? 'üôà' : 'üëÅ';
        btn.setAttribute('aria-label', shown ? 'Sembunyikan kata laluan' : 'Tunjuk kata laluan');
        // Kekalkan fokus pada input bila toggle
        pwd.focus({ preventScroll:true });
      }
      btn.addEventListener('click', ()=>{ shown = !shown; update(); });
      // tekan & tahan (optional): tunjuk sementara
      btn.addEventListener('mousedown', (e)=>{ e.preventDefault(); shown = true; update(); });
      btn.addEventListener('mouseup',   ()=>{ shown = false; update(); });
      btn.addEventListener('mouseleave',()=>{ if (shown) { shown = false; update(); } });
    })();

    // Inisialisasi login handler dari auth.js (Option B retry)
    document.addEventListener('DOMContentLoaded', ()=> {
      if (window.WFH && typeof WFH.initLogin === 'function') WFH.initLogin();
    });
  </script>
</body>
</html>
