<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Login – WFH</title>
  <style>
    :root{--bg:#0b1020;--card:#121a33;--muted:#b8c7ff;--accent:#4da3ff;--ok:#34d399;--err:#ef4444}
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#0b1020,#0e1429 40%,#0b1020);font-family:Inter,system-ui,Segoe UI,Arial;color:#e9eeff;display:grid;place-items:center;padding:24px}
    .card{width:min(420px,92vw);background:#121a33;border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:24px 20px;box-shadow:0 30px 120px rgba(0,0,0,.6)}
    h1{margin:0 0 12px;font-size:22px}
    label{display:block;margin:12px 0 6px;font-weight:600}
    input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#0c132a;color:#e9eeff}
    .row{display:flex;gap:10px;align-items:center;margin-top:16px}
    button{padding:10px 14px;border-radius:12px;border:0;background:var(--accent);color:#001333;font-weight:700;cursor:pointer}
    a{color:var(--accent);text-decoration:none}
    .status{margin-top:10px}
    .status.ok{color:var(--ok)} .status.err{color:var(--err)}
    .muted{color:var(--muted)}
    /* loading overlay */
    .loading{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.72);backdrop-filter:blur(4px);z-index:70}
    .loading.show{display:flex}
    .loading-box{width:min(92%,420px);text-align:center;background:#121a33;border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:24px 20px}
    .spinner{width:54px;height:54px;border-radius:50%;margin:0 auto 12px;border:6px solid rgba(255,255,255,.12);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div class="card">
    <h1>Log Masuk WFH</h1>
    <p class="muted" style="margin:0 0 10px">Sila masukkan emel dan kata laluan.</p>

    <!-- PENTING: id & name MESTI sama seperti di initLogin -->
    <form id="loginForm" action="javascript:void(0)">
      <label for="email">Emel</label>
      <input id="email" name="email" type="email" autocomplete="username" required>

      <label for="password">Kata Laluan</label>
      <input id="password" name="password" type="password" autocomplete="current-password" required>

      <div class="row">
        <button type="submit">Login</button>
        <a href="forgot.html">Lupa kata laluan?</a>
      </div>

      <div id="loginStatus" class="status"></div>
    </form>
  </div>

  <!-- Loading overlay -->
  <div id="loginLoading" class="loading" aria-live="polite" aria-busy="true">
    <div class="loading-box">
      <div class="spinner" aria-hidden="true"></div>
      <h4>Memproses…</h4>
      <p id="loginLoadingMsg">Mengesahkan akaun…</p>
    </div>
  </div>

  <!-- MUATKAN auth.js DENGAN 'defer' + cache-buster -->
  <script src="auth.js?v=20250909b" defer></script>
  <script>
    // Fallback: jika atas sebab tertentu onload tak tembak, kita panggil selepas DOM siap.
    document.addEventListener('DOMContentLoaded', function(){
      if (window.WFH && typeof WFH.initLogin==='function') {
        WFH.initLogin();
      } else {
        // Tunggu seketika kalau auth.js belum siap
        const t = setInterval(()=> {
          if (window.WFH && typeof WFH.initLogin==='function') {
            clearInterval(t); WFH.initLogin();
          }
        }, 100);
        setTimeout(()=>clearInterval(t), 4000);
      }
    });
  </script>
</body>
</html>
